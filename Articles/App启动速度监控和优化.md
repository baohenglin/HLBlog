# App启动速度的监控与优化

一般地，App 的启动分为冷启动和热启动两种。

* **冷启动**是指App点击启动前，它的进程不在系统里，需要系统新创建一个进程分配给它启动的情况。这是一次完整的启动过程。
* **热启动**是指App在冷启动之后用户将App退到后台，在 App 的进程还在系统里的情况下，用户重新启动进入 App 的过程。

冷启动相比热启动执行的操作要多得多，所以我们此处只论述针对冷启动的监控与优化。用户能感知到的启动速度慢，其实都发生在主线程上。而主线程慢的原因有很多，比如在主线程上执行了大文件读写操作、在渲染周期中执行了大量计算等。那么如何将启动时所有耗时操作都找出来呢？为了解决此问题，我们需要首先弄清楚App在启动时都做了什么。

App的启动过程主要分为三个阶段：

* (1) main()函数执行前；
* (2) main()函数执行后；
* (3) 首屏渲染完成后。


## main() 函数执行前

在执行 main()函数前，系统做的事情包括：

* 加载可执行文件（App的.o文件的集合）；
* 加载动态链接库，进行 rebase 指针调整和 bind 符号绑定；
* Objc 运行时的初始处理，包括Objc相关类的注册、category 注册、selector唯一性检查等；
* 初始化，包括了执行 +load() 方法、attribute((constructor))修饰的函数的调用、创建 C++静态全局变量。

这个阶段可以从下面几个方面来进行启动速度优化：

* 减少动态库加载。
